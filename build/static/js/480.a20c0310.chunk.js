"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[480,744],{4219:function(e,t,r){r.d(t,{Z:function(){return m}});var n=r(9439),s=r(2791),a=r(4165),i=r(5861),o=r(6213),c="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt6eWxud3Fib2FiZnhpZmpzZXZpIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTY3NDYzNjI0MiwiZXhwIjoxOTkwMjEyMjQyfQ.9YzPtaUZzqkGKve6PI5MtH_otfv1jh521NugK9dqyis",u="https://kzylnwqboabfxifjsevi.supabase.co";function l(e,t,r){return f.apply(this,arguments)}function f(){return(f=(0,i.Z)((0,a.Z)().mark((function e(t,r,n){var s,i,l,f;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(0,o.eI)(u,c),n&&t&&r){e.next=3;break}return e.abrupt("return","user and index must be valid for RATING...!!!");case 3:return e.next=5,s.from("Favorite movies").update({rating:n}).eq("user_id",t).eq("movie_id",r);case 5:if(i=e.sent,l=i.data,f=i.error){e.next=13;break}return console.log(l),e.abrupt("return",!0);case 13:return console.log(f.message,"Unable to rate this. who the fuck are you."),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var d=r(9440),p=r(184),h=function(e){var t=function(){var t=(0,i.Z)((0,a.Z)().mark((function t(r){var n;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.userId){t.next=5;break}console.log(e.userId,"user wasnt logged in!@@@"),e.setMustLoginModal(!0),t.next=12;break;case 5:return e.changeGrade(r.target.value),t.next=8,l(e.userId,e.id,parseInt(r.target.value));case 8:n=t.sent,console.log(d.Z,n),(0,d.Z)(e.userId),console.log(r.target.value,n,"STAR");case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,p.jsxs)("label",{className:"star",children:[(0,p.jsx)("input",{onClick:t,type:"radio",name:"rating",id:e.grade,value:e.index,className:"stars_radio-input"}),(0,p.jsx)("svg",{width:"30",height:"30",viewBox:"0 0 24 24",fill:"none",stroke:"#fce500",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",style:e.style,children:(0,p.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})]})};var m=function(e){var t=(0,s.useState)(),r=(0,n.Z)(t,2),a=r[0],i=r[1],o=function(e){i(e)},c={fill:"#fce500"};return(0,s.useEffect)((function(){e.rating&&(console.log("set gradeindex now"),i(e.rating))}),[e.rating]),(0,s.useEffect)((function(){console.log(a)}),[a]),(0,p.jsx)("div",{className:"stars",children:["Poor","Fair","Good","Very good","Excellent"].map((function(t,r){return(0,p.jsx)(h,{index:r,style:a>=r?c:{},changeGrade:o,userId:e.userId,id:e.id,saved:e.saved,setMustLoginModal:e.setMustLoginModal},t)}))})}},715:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var n=r(4165),s=r(5861),a=r(9439),i=r(2791),o=r(1087),c=r(4219),u=r(184);function l(e){var t=e.movie,r=e.ratings,n=e.userId;return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)("div",{className:"favoriteItem",children:[(0,u.jsx)("img",{src:t.Poster,alt:"."}),(0,u.jsxs)("div",{className:"favoriteItemDetails",children:[(0,u.jsxs)("span",{className:"favoriteItemTitle",children:[(0,u.jsx)("h1",{className:"text-xl font-medium flex w-4/5 h-full items-center justify-between",children:(0,u.jsxs)(o.rU,{className:"hover:text-yellow-400",to:"/movie",state:{id:t.imdbID},children:[t.Title," (",t.Released,")"]})}),(0,u.jsxs)("a",{className:"text-xl hover:text-yellow-300",href:"https://www.imdb.com/title/".concat(t.imdbID,"/"),children:[t.imdbRating,"/10"]})]}),(0,u.jsxs)("span",{className:"favoriteItemTitle2 w-full text-sm",children:[t.Rated," | ",t.Genre," | ",t.Runtime]}),(0,u.jsxs)("div",{className:"favoriteItemDetail w-full px-2 mt-3",children:[(0,u.jsx)("h1",{className:"font-normal text-m line-clamp-3",children:t.Plot}),(0,u.jsxs)("span",{className:"flex flex-col justify-evenly w-full ml-0 mt-1 text-sm h-16",children:[(0,u.jsxs)("h1",{children:["Director: ",t.Director]}),(0,u.jsxs)("h1",{children:["Writer: ",t.Writer]}),(0,u.jsxs)("h1",{children:["Actors: ",t.Actors]})]})]}),(0,u.jsxs)("div",{className:"flex w-full h-1/6 items-center px-2",id:"favoritePostersRating",children:[(0,u.jsx)("h1",{children:"Rate this movie : "}),(0,u.jsx)(c.Z,{userId:n,id:t.imdbID,rating:r[t.imdbID]})]})]})]},t.imdbID)})}var f=r(3263);function d(){return d=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length<=0)){e.next=2;break}return e.abrupt("return",!1);case 2:return r=[],Object.keys(t).forEach(function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"GET",url:"https://www.omdbapi.com/?apikey=c7326058&&i=".concat(t,"&plot=full")},e.next=3,f.Z.request(s).then((function(e){console.log("this is fetchall",e.data),r.push(e.data)})).catch((function(e){console.error("fetchall err",e)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}var p=function(e){return d.apply(this,arguments)};var h=function(e){var t=localStorage.getItem("userId"),r=(0,i.useState)([]),o=(0,a.Z)(r,2),c=o[0],f=o[1],d=(0,i.useState)(JSON.parse(localStorage.getItem("ratings"))),h=(0,a.Z)(d,2),m=h[0],v=(h[1],function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m){e.next=8;break}return e.next=3,p(m);case 3:t=e.sent,console.log(t.length,"fetched"),r=t.sort((function(e,t){return parseInt(e.Year)+parseInt(t.Year)})),f(r),console.log(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return(0,i.useEffect)((function(){m&&v()}),[]),(0,u.jsx)("div",{id:"favorite",children:c&&c.length>0&&c.map((function(e){return(0,u.jsx)(l,{movie:e,ratings:m,userId:t})}))})};var m=function(){var e=localStorage.getItem("userId"),t=(0,i.useState)(""),c=(0,a.Z)(t,2),l=c[0],f=c[1],d=(0,i.useState)([]),p=(0,a.Z)(d,2),m=p[0];p[1],(0,i.useEffect)((function(){e?console.log(e,"user has signed in"):console.log(e,"user has not signed in!!!"),console.log(l),v()}),[]);var v=function(){var t=(0,s.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.e(894).then(r.bind(r,9894)).then(function(){var t=(0,s.Z)((0,n.Z)().mark((function t(r){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.SupabaseUsername(e,f);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,u.jsx)("div",{id:"contFavorites",children:(0,u.jsxs)("div",{id:"contFavorite",children:[(0,u.jsxs)("span",{className:"relative h-12 w-full flex items-center justify-center bg-yellow-400/80 text-black tracking-widest font-bold",children:[(0,u.jsx)(o.rU,{to:"/",className:"absolute left-2",children:"< HOME"}),(0,u.jsxs)("h1",{children:[l,"'s watchlist"]})]}),(0,u.jsx)(h,{ratings:m})]})})}},9440:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(4165),s=r(5861),a=r(7744);function i(e){return o.apply(this,arguments)}function o(){return(o=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.SupabaseFavorite)(t);case 2:(r=e.sent)&&localStorage.setItem("ratings",JSON.stringify(r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},7744:function(e,t,r){r.r(t),r.d(t,{SupabaseFavorite:function(){return c}});var n=r(4165),s=r(5861),a=r(6213),i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt6eWxud3Fib2FiZnhpZmpzZXZpIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTY3NDYzNjI0MiwiZXhwIjoxOTkwMjEyMjQyfQ.9YzPtaUZzqkGKve6PI5MtH_otfv1jh521NugK9dqyis",o="https://kzylnwqboabfxifjsevi.supabase.co";function c(e){return u.apply(this,arguments)}function u(){return(u=(0,s.Z)((0,n.Z)().mark((function e(t){var r,s,c,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,a.eI)(o,i),t){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,r.from("Favorite movies").select("movie_id,rating").eq("user_id",t);case 5:if(s=e.sent,c=s.data,u=s.error){e.next=19;break}if(0!==c.length){e.next=13;break}return e.abrupt("return",!1);case 13:return l={},c.map((function(e){l[e.movie_id]=e.rating})),console.log(l),e.abrupt("return",l);case 17:e.next=21;break;case 19:return console.log(u,"cant get user favorites"),e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=480.a20c0310.chunk.js.map